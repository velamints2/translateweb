# ğŸ”Œ ç«¯å£é…ç½®è¯´æ˜

## å½“å‰ç«¯å£é…ç½®

### âœ… æ­£ç¡®çš„ç«¯å£
- **å‰ç«¯æœåŠ¡å™¨**: `http://localhost:3000`
- **åç«¯æœåŠ¡å™¨**: `http://localhost:3001`

---

## é—®é¢˜è¯´æ˜

### é—®é¢˜1: .envæ–‡ä»¶æƒé™é—®é¢˜
**ç—‡çŠ¶**: 
```
Error: EPERM: operation not permitted, open '.env'
```

**åŸå› **: 
- macOSçš„æ–‡ä»¶æ‰©å±•å±æ€§é˜»æ­¢äº†è®¿é—®
- æ–‡ä»¶æœ‰ `com.apple.provenance` å±æ€§

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤æ‰©å±•å±æ€§
xattr -c .env

# é‡æ–°è®¾ç½®æƒé™
chmod 644 .env
```

**çŠ¶æ€**: âœ… å·²è§£å†³

---

### é—®é¢˜2: ç«¯å£é…ç½®æ··æ·†

**é”™è¯¯ä¿¡æ¯**: ä¹‹å‰æ–‡æ¡£ä¸­é”™è¯¯åœ°å†™æˆ5173ç«¯å£

**æ­£ç¡®é…ç½®** (vite.config.js):
```javascript
server: {
  port: 3000,  // â† å‰ç«¯å®é™…ç«¯å£
  host: '0.0.0.0',
  proxy: {
    '/api': {
      target: 'http://localhost:3001',  // â† åç«¯ç«¯å£
      changeOrigin: true
    }
  }
}
```

**çŠ¶æ€**: âœ… å·²æ›´æ­£

---

## ç«¯å£è¯¦ç»†è¯´æ˜

### å‰ç«¯æœåŠ¡å™¨ (Vite)
- **ç«¯å£**: 3000
- **åè®®**: HTTP
- **è®¿é—®**: http://localhost:3000
- **é…ç½®æ–‡ä»¶**: `vite.config.js`

### åç«¯æœåŠ¡å™¨ (Express)
- **ç«¯å£**: 3001
- **åè®®**: HTTP
- **è®¿é—®**: http://localhost:3001
- **é…ç½®æ–‡ä»¶**: `.env` (PORT=3001)

### APIä»£ç†
å‰ç«¯ä¼šè‡ªåŠ¨å°† `/api/*` è¯·æ±‚ä»£ç†åˆ°åç«¯ï¼š
```
http://localhost:3000/api/submit-text
    â†“ (ä»£ç†)
http://localhost:3001/api/submit-text
```

---

## éªŒè¯æœåŠ¡å™¨çŠ¶æ€

### æ£€æŸ¥å‰ç«¯
```bash
curl http://localhost:3000/
# åº”è¯¥è¿”å›HTMLé¡µé¢
```

### æ£€æŸ¥åç«¯
```bash
curl http://localhost:3001/health
# åº”è¯¥è¿”å›: {"status":"OK","mode":"Local Agent","timestamp":"..."}
```

### æ£€æŸ¥APIä»£ç†
```bash
curl http://localhost:3000/api/history
# åº”è¯¥é€šè¿‡ä»£ç†è®¿é—®åç«¯API
```

---

## å¯åŠ¨æœåŠ¡

### æ–¹å¼1: æ‰‹åŠ¨å¯åŠ¨ï¼ˆæ¨èï¼‰
```bash
# ç»ˆç«¯1 - å¯åŠ¨åç«¯
npm run server

# ç»ˆç«¯2 - å¯åŠ¨å‰ç«¯
npm run dev
```

### æ–¹å¼2: ä½¿ç”¨å¯åŠ¨è„šæœ¬
```bash
./start-dev.sh
```

---

## ç«¯å£å†²çªè§£å†³

### å¦‚æœ3000ç«¯å£è¢«å ç”¨

**æŸ¥æ‰¾å ç”¨è¿›ç¨‹**:
```bash
lsof -i :3000
```

**ç»ˆæ­¢è¿›ç¨‹**:
```bash
kill -9 <PID>
```

**ä¿®æ”¹ç«¯å£** (vite.config.js):
```javascript
server: {
  port: 8080,  // æ”¹æˆå…¶ä»–ç«¯å£
  // ...
}
```

### å¦‚æœ3001ç«¯å£è¢«å ç”¨

**æŸ¥æ‰¾å ç”¨è¿›ç¨‹**:
```bash
lsof -i :3001
```

**ä¿®æ”¹ç«¯å£** (.env):
```bash
PORT=8081  # æ”¹æˆå…¶ä»–ç«¯å£
```

**åŒæ—¶ä¿®æ”¹å‰ç«¯ä»£ç†é…ç½®** (vite.config.js):
```javascript
proxy: {
  '/api': {
    target: 'http://localhost:8081',  // æ”¹æˆæ–°ç«¯å£
    // ...
  }
}
```

---

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¸ç”¨5173ç«¯å£ï¼Ÿ
**A**: 5173æ˜¯Viteçš„é»˜è®¤ç«¯å£ï¼Œä½†æœ¬é¡¹ç›®é…ç½®ä¸º3000ç«¯å£ã€‚

### Q: ä¸ºä»€ä¹ˆå‰åç«¯ç”¨ä¸åŒç«¯å£ï¼Ÿ
**A**: 
- å‰åç«¯åˆ†ç¦»æ¶æ„
- æ–¹ä¾¿å¼€å‘è°ƒè¯•
- æ”¯æŒè·¨åŸŸä»£ç†

### Q: ç”Ÿäº§ç¯å¢ƒä¹Ÿç”¨è¿™äº›ç«¯å£å—ï¼Ÿ
**A**: ä¸æ˜¯ã€‚ç”Ÿäº§ç¯å¢ƒé€šå¸¸ï¼š
- å‰ç«¯æ„å»ºåéƒ¨ç½²åˆ°CDNæˆ–é™æ€æœåŠ¡å™¨
- åç«¯ä½¿ç”¨80/443ç«¯å£
- é€šè¿‡Nginxç­‰åå‘ä»£ç†

---

## é˜²ç«å¢™é…ç½®

### macOS
```bash
# å…è®¸3000ç«¯å£
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --add 3000

# å…è®¸3001ç«¯å£
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --add 3001
```

### Linux
```bash
# å…è®¸3000ç«¯å£
sudo ufw allow 3000

# å…è®¸3001ç«¯å£
sudo ufw allow 3001
```

---

## ç¯å¢ƒå˜é‡

### .env æ–‡ä»¶
```bash
# åç«¯ç«¯å£
PORT=3001

# å…¶ä»–é…ç½®
NODE_ENV=development
USE_LOCAL_AGENT=true
ANTHROPIC_API_KEY=your_key_here
```

### vite.config.js
```javascript
export default defineConfig({
  server: {
    port: 3000,  // å‰ç«¯ç«¯å£
    // ...
  }
})
```

---

## æ€»ç»“

| æœåŠ¡ | ç«¯å£ | è®¿é—®åœ°å€ | çŠ¶æ€ |
|------|------|----------|------|
| å‰ç«¯ | 3000 | http://localhost:3000 | âœ… è¿è¡Œä¸­ |
| åç«¯ | 3001 | http://localhost:3001 | âœ… è¿è¡Œä¸­ |
| åç«¯API | 3001 | http://localhost:3001/api | âœ… è¿è¡Œä¸­ |
| å¥åº·æ£€æŸ¥ | 3001 | http://localhost:3001/health | âœ… æ­£å¸¸ |

---

**æ–‡æ¡£åˆ›å»º**: 2025-11-29  
**çŠ¶æ€**: âœ… å·²ä¿®å¤å¹¶éªŒè¯  
**å‰ç«¯ç«¯å£**: 3000 (æ­£ç¡®)  
**åç«¯ç«¯å£**: 3001 (æ­£ç¡®)

